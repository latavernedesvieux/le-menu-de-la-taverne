<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Menu de la Taverne ‚Äî Biblioth√®que</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@import url('https://fonts.googleapis.com/css2?family=MedievalSharp&family=Inter:wght@300;400;600&display=swap');

/* ==== Fond g√©n√©ral ==== */
body {
  font-family: "Inter", sans-serif;
  margin: 0;
  padding: 0;
  background: url('https://cdna.artstation.com/p/assets/images/images/014/112/166/large/fabrice-levacher-taverne-couleur-ambiance.jpg?1542536264') center/cover no-repeat fixed;
  color: #3b2b1f;
}
body::before {
  content:"";
  position:fixed;
  inset:0;
  background: rgba(60,40,20,0.5);
  z-index:-1;
  pointer-events:none;
}

/* ==== Conteneur principal ==== */
.page {
  max-width: 1200px;
  margin: 2rem auto;
  background: rgba(245,235,210,0.85);
  border: 6px solid #5b3a1a;
  border-radius: 24px;
  box-shadow: 0 25px 60px rgba(0,0,0,0.7);
  padding: 40px;
}

/* ==== Titres ==== */
.title {
  font-family: "MedievalSharp", serif;
  font-size: 3rem;
  color:#5b3a1a;
  text-shadow: 2px 2px 6px rgba(0,0,0,0.4);
}
.subtitle {
  color:#6b4b2f;
  font-size:1.3rem;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
}

/* ==== Cartes de jeux ==== */
.card {
  background: linear-gradient(180deg, rgba(255,245,224,0.95) 0%, rgba(242,227,192,0.9) 100%);
  border-radius: 20px;
  border: 2px solid #5b3a1a;
  display: flex;
  flex-direction: row;
  gap:1rem;
  padding:1.2rem;
  box-shadow: 0 10px 25px rgba(0,0,0,0.35);
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  cursor: pointer;
}
.card:hover {
  transform: translateY(-6px) scale(1.03);
  box-shadow: 0 18px 40px rgba(0,0,0,0.5);
}
.jaquette {
  width:100%;
  max-width: 200px;
  height:140px;
  object-fit:cover;
  border-radius:12px;
  border:2px solid #5b3a1a;
}

/* ==== Badges ==== */
.badge-available{ background:#3c7d1f; color:white; padding:.35rem .7rem; border-radius:999px; font-weight:600; font-size:.95rem;}
.badge-reserved{ background:#d97706; color:white; padding:.35rem .7rem; border-radius:999px; font-weight:600; font-size:.95rem;}
.badge-soon{ background:#6b4b2f; color:white; padding:.35rem .7rem; border-radius:999px; font-weight:600; font-size:.95rem;}

/* ==== Boutons ==== */
button.vote-btn {
  background: linear-gradient(45deg, #d4af37, #a86b2a);
  color:white;
  font-weight:700;
  padding:0.7rem 1.6rem;
  border-radius:14px;
  border:2px solid #5b3a1a;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.4);
  cursor:pointer;
  transition: all 0.3s ease;
}
button.vote-btn:hover { background: linear-gradient(45deg, #a86b2a, #d4af37); transform: scale(1.05); }

#add-game-btn {
  margin-top: 1rem;
  background: linear-gradient(45deg, #d4af37, #a86b2a);
  color:white;
  font-weight:700;
  padding:0.9rem 2.2rem;
  border-radius:16px;
  border:2px solid #5b3a1a;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
  font-size:1.2rem;
}
#add-game-btn:hover { transform: scale(1.05); background: linear-gradient(45deg, #a86b2a, #d4af37); }

/* ==== Popups ==== */
.popup {
  display:none;
  position:fixed;
  inset:0;
  background: rgba(0,0,0,0.85);
  z-index:50;
  align-items:center;
  justify-content:center;
}
.popup .popup-content {
  background: #fff5e0;
  padding:2rem;
  border-radius:18px;
  max-width:600px;
  width:90%;
  text-align:center;
  box-shadow: 0 14px 35px rgba(0,0,0,0.6);
  position: relative;
}
.popup img {
  width:100%;
  border-radius:12px;
  border:2px solid #5b3a1a;
  margin-bottom:1rem;
}
.popup .close-popup {
  position:absolute;
  top:0.5rem;
  right:0.8rem;
  cursor:pointer;
  font-weight:bold;
  color:#3b2b1f;
  font-size:1.4rem;
}
.popup input { width:80%; padding:0.7rem; border:2px solid #5b3a1a; border-radius:10px; margin-top:1rem; }
</style>
</head>
<body>
<div class="page">
  <header class="mb-6">
    <h1 class="title">Le Menu de la Taverne</h1>
  </header>
  <p class="subtitle mb-6">üçª D√©couvrez, r√©servez ou sugg√©rez vos jeux favoris !</p>

  <section class="grid grid-cols-1 md:grid-cols-2 gap-6" id="games-container"></section>

  <h2 class="title mt-12 text-2xl">Jeux souhait√©s par la communaut√©</h2>
  <section class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4" id="wish-container"></section>

  <h2 class="title mt-12 text-2xl">Ajouter un jeu √† sugg√©rer</h2>
  <button id="add-game-btn">Ajouter un jeu √† sugg√©rer</button>

  <footer class="mt-10 text-sm text-center">
    <p>¬© Le Menu de la Taverne ‚Äî Donnez vie √† votre biblioth√®que.</p>
  </footer>
</div>

<!-- Popup d√©tail jeu -->
<div id="detail-popup" class="popup">
  <div class="popup-content">
    <span class="close-popup">&times;</span>
    <img id="detail-img" src="" alt="">
    <h3 id="detail-title" class="text-2xl font-bold mb-2"></h3>
    <p id="detail-desc" class="text-sm mb-3"></p>
    <p id="detail-copies" class="font-semibold mb-3"></p>

    <!-- Formulaire Formspree -->
    <form id="reserve-form" action="https://formspree.io/f/XXXXXXX" method="POST">
      <input type="text" name="pseudo" id="reserve-pseudo" placeholder="Votre pseudo" required>
      <input type="hidden" name="jeu" id="reserve-jeu">
      <button type="submit" class="vote-btn mt-2">üïπÔ∏è R√©server ce jeu</button>
      <p id="reserve-msg" class="mt-2 text-green-700 font-semibold"></p>
    </form>
  </div>
</div>

<!-- Popup suggestion -->
<div id="suggest-popup" class="popup">
  <div class="popup-content">
    <span class="close-popup">&times;</span>
    <h3 class="text-xl font-semibold">Sugg√©rer un jeu</h3>
    <input type="text" id="suggest-pseudo" placeholder="Votre pseudo">
    <input type="text" id="suggest-link" placeholder="Nom ou lien du jeu">
    <button id="submit-suggest" class="vote-btn">Envoyer la suggestion</button>
    <p id="suggest-msg" class="mt-2 text-green-700 font-semibold"></p>
  </div>
</div>

<script id="game-data" type="application/json">
[{"title":"Voidtrain","appid":"1159690","status":"disponible","desc":"Devenez membre d'√©quipage d'un train interdimensionnel...","copies":1},
{"title":"Sons of the Forest","appid":"1326470","status":"disponible","desc":"Survivre dans un open-world survival-horror, seul ou en coop.","copies":1},
{"title":"Icarus","appid":"1149460","status":"disponible","desc":"Survival ax√© sur des missions et un monde persistant.","copies":1},
{"title":"Abiotic Factor","appid":"427410","status":"disponible","desc":"Survie et crafting dans une installation souterraine.","copies":1},
{"title":"Gray Zone Warfare","appid":"2479810","status":"disponible","desc":"Hardcore tactical FPS dans les jungles d‚ÄôAsie du Sud-Est.","copies":1},
{"title":"Remnant 2","appid":"1282100","status":"disponible","desc":"Affrontez des cr√©atures et boss divins dans un monde terrifiant.","copies":1},
{"title":"Ready or Not","appid":"1144200","status":"disponible","desc":"FPS tactique intense : incarnez une unit√© SWAT moderne.","copies":1},
{"title":"Peak","appid":"3527290","status":"disponible","desc":"A survival crafting game set in frozen peaks.","copies":1},
{"title":"Green Hell","appid":"815370","status":"R√©serv√©","desc":"Survival r√©aliste en plein c≈ìur de l‚ÄôAmazonie, affrontez la nature et vos propres limites.","copies":1},
{"title":"Lens Island","appid":"1335830","status":"disponible","desc":"Explorez une √Æle myst√©rieuse et survivez aux dangers.","copies":2},
{"title":"SnowRunner","appid":"1465360","status":"R√©serv√©","desc":"Simulation tout-terrain avec missions et v√©hicules puissants.","copies":1},
{"title":"Dying Light 2","appid":"534380","status":"prochainement","desc":"Un monde ouvert o√π vos choix influencent la survie.","copies":1},
{"title":"Enshrouded","appid":"1203620","status":"R√©serv√©","desc":"Survival coop√©ratif dans un vaste monde brumeux.","copies":1},
{"title":"No Man's Sky","appid":"275850","status":"R√©serv√©","desc":"Exploration et survie dans un univers infini.","copies":1},
{"title":"Baldur's Gate 3","appid":"1086940","status":"R√©serv√©","desc":"Constituez votre groupe et retournez aux Royaumes Oubli√©s.","copies":1},
{"title":"RV There Yet","appid":"3949040","status":"R√©serv√©","desc":"Jeu coop√©ratif de conduite d‚Äôune caravane jusqu‚Äô√† la maison.","copies":1},
{"title":"Tom Clancy's ghost recon breakpoint","appid":"2231380","status":"R√©serv√©","desc":"Devenez un Ghost, face √† une faction Spec Ops dissidente nomm√©e les Wolves, dans le dernier Tom Clancy's Ghost Recon !","copies":1},
{"title":"Arma Reforger","appid":"1874880","status":"R√©serv√©","desc":"La Guerre froide vient d'√©clater et vous allez d√©couvrir le bac √† sable militaire le plus immersif jamais con√ßu.","copies":1},
{"title":"Ark Survival Ascended","appid":"2399830","status":"R√©serv√©","desc":"Formez une tribu, explorez, √©laborez et construisez votre chemin jusqu'au sommet de la cha√Æne de nourriture.","copies":1},
{"title":"Dinkum","appid":"1062520","status":"R√©serv√©","desc":"Recueille des ressources en cultivant, en chassant, en minant, en p√™chant et en cueillant, d√©veloppe ta ville et d√©couvre ce qui rend Dinkum si sp√©cial, en solo ou avec des amis.","copies":1},
{"title":"Spyro Reignited Trilogy","appid":"996580","status":"R√©serv√©","desc":"Toujours aussi br√ªlant et attachant, Spyro revient dans une HD flamboyante...","copies":1},
{"title":"Megabonk","appid":"3405340","status":"R√©serv√©","desc":"Fracasse des vagues infinies d‚Äôennemis et deviens surpuissant en repoussant les hordes de cr√©atures !","copies":1},
{"title":"Monster Hunter Rise","appid":"1446780","status":"R√©serv√©","desc":"vous incarnez un chasseur, partez √† la d√©couverte de r√©gions inexplor√©es et venez √† bout de monstres redoutables au cours d'histoires in√©dites.","copies":1},
{"title":"Phasmophobia","appid":"739630","status":"R√©serv√©","desc":"La phasmophobie est une horreur psychologique coop√©rative en ligne pour 4 joueurs, o√π vous et votre √©quipe de membres d'enqu√™teurs paranormaux entrez dans des lieux hant√©s...","copies":1},
{"title":"Jagged Alliance 3","appid":"1084160","status":"R√©serv√©","desc":"Engagez des mercenaires, rencontrez de sacr√©s personnages et combattez au tour par tour dans ce nouvel opus d‚Äôune franchise culte.","copies":1},
{"title":"Mortal Kombat 11","appid":"976310","status":"R√©serv√©","desc":"Mortal Kombat est de retour dans un nouvel √©pisode de la s√©rie embl√©matique, plus explosif que jamais !","copies":1},
{"title":"Powerwash simulator 2","appid":"2968420","status":"R√©serv√©","desc":"PowerWash Simulator revient avec des missions de nettoyage...","copies":1}]
</script>

<script>
const data = JSON.parse(document.getElementById("game-data").textContent);
const container = document.getElementById("games-container");
const wishContainer = document.getElementById("wish-container");

// Popup d√©tail
const popup = document.getElementById("detail-popup");
const closeBtn = popup.querySelector(".close-popup");
const popupImg = document.getElementById("detail-img");
const popupTitle = document.getElementById("detail-title");
const popupDesc = document.getElementById("detail-desc");
const popupCopies = document.getElementById("detail-copies");
const reserveForm = document.getElementById("reserve-form");
const reserveJeu = document.getElementById("reserve-jeu");
const reserveMsg = document.getElementById("reserve-msg");

// Popup suggestion
const suggestPopup = document.getElementById("suggest-popup");
const addGameBtn = document.getElementById("add-game-btn");
const closeSuggest = suggestPopup.querySelector(".close-popup");
const submitSuggest = document.getElementById("submit-suggest");
const suggestPseudo = document.getElementById("suggest-pseudo");
const suggestLink = document.getElementById("suggest-link");
const suggestMsg = document.getElementById("suggest-msg");

function steamHeader(id){ return `https://cdn.cloudflare.steamstatic.com/steam/apps/${id}/header.jpg`; }

data.forEach(g=>{
  const card=document.createElement("article");
  card.className="card";
  const img=document.createElement("img");
  img.src=steamHeader(g.appid);
  img.alt=g.title+" jaquette";
  img.className="jaquette";
  const body=document.createElement("div");
  const title=document.createElement("h3");
  title.className="font-semibold text-xl mb-1";
  title.textContent=g.title;

  const badge=document.createElement("span");
  if(g.status==="disponible") badge.innerHTML='<span class="badge-available">Disponible</span>';
  else if(g.status==="R√©serv√©") badge.innerHTML='<span class="badge-reserved">R√©serv√©</span>';
  else badge.innerHTML='<span class="badge-soon">Prochainement</span>';

  const copies=document.createElement("p");
  copies.className="text-sm mt-1 italic";
  copies.textContent=`üéÆ Exemplaires disponibles : ${g.copies}`;

  const desc=document.createElement("p");
  desc.className="mt-1 text-sm";
  desc.textContent=g.desc;

  body.append(title,badge,desc,copies);
  card.append(img,body);

  card.addEventListener("click", ()=>{
    popup.style.display="flex";
    popupImg.src=steamHeader(g.appid);
    popupTitle.textContent=g.title;
    popupDesc.textContent=g.desc;
    popupCopies.textContent=`Exemplaires disponibles : ${g.copies}`;
    reserveJeu.value = g.title;
    reserveMsg.textContent="";
  });

  if(g.status==="disponible"||g.status==="R√©serv√©") container.appendChild(card);
  else wishContainer.appendChild(card);
});

closeBtn.addEventListener("click", ()=> popup.style.display="none");
window.addEventListener("click", e=>{ if(e.target===popup) popup.style.display="none"; });

// ==== Formspree r√©servation ====
reserveForm.addEventListener("submit", e=>{
  e.preventDefault();
  fetch(reserveForm.action, {
    method: reserveForm.method,
    body: new FormData(reserveForm),
    headers: { 'Accept': 'application/json' }
  }).then(response=>{
    if(response.ok){
      reserveMsg.textContent = "‚úÖ R√©servation envoy√©e !";
      setTimeout(()=>{ popup.style.display="none"; reserveMsg.textContent=""; }, 2000);
      reserveForm.reset();
    } else { reserveMsg.textContent="‚ùå Erreur lors de l'envoi."; }
  }).catch(()=>{ reserveMsg.textContent="‚ùå Impossible d'envoyer."; });
});

// ==== Suggestion ====
addGameBtn.addEventListener("click", ()=> suggestPopup.style.display="flex");
closeSuggest.addEventListener("click", ()=> suggestPopup.style.display="none");
window.addEventListener("click", e=>{ if(e.target===suggestPopup) suggestPopup.style.display="none"; });

submitSuggest.addEventListener("click", ()=>{
  const pseudo=suggestPseudo.value.trim();
  const link=suggestLink.value.trim();
  if(!pseudo||!link){ suggestMsg.textContent="‚ö†Ô∏è Remplissez les champs."; return; }

  fetch("https://formspree.io/f/XXXXXXX", {
    method:"POST",
    body: JSON.stringify({ pseudo, jeu: link }),
    headers:{ "Accept":"application/json","Content-Type":"application/json" }
  }).then(r=>{
    if(r.ok){
      suggestMsg.textContent="‚úÖ Suggestion envoy√©e !";
      setTimeout(()=>{ suggestPopup.style.display="none"; suggestMsg.textContent=""; },2000);
      suggestPseudo.value=""; suggestLink.value="";
    } else suggestMsg.textContent="‚ùå Erreur.";
  }).catch(()=> suggestMsg.textContent="‚ùå Envoi impossible.");
});
</script>
</body>
</html>

